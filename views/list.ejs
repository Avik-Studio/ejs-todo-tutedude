<!DOCTYPE html>
<html lang="en">
<head>
    <title>Todo list</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="box">
        <h1>Todo list</h1>
        <form action="/" method="GET" class="filter-form" id="filter-form">
            <label for="priority-filter">Filter ny Priority</label>
            <select name="priority" id="priority-filter" onchange="document.getElementById('filterFrom').submit()">
                <option value="all" <%= currentPriority==="all" ? "selected" : "" %>>All Task</option>
                <option value="high" <%= currentPriority==="high" ? "selected" : "" %>>High</option>
                <option value="medium" <%= currentPriority==="medium" ? "selected" : "" %>>Medium</option>
                <option value="low" <%= currentPriority==="low" ? "selected" : "" %>>Low</option>
            </select>
        </form>
    </div>
    <div class="box">
        <div class="items">
             <% if(items && items.length > 0){ %>
                <% for(var j=0; j<items.length; j++){ %>
                    <% var i = indices[j]; %>
                    <div class="task-item <%= items[j].priority %>-priority">
                        <input type="checkbox">
                        <div class="task-content">
                            <p><%= items[j].text %></p>
                            <span class="priority-badge <%= items[j].priority %>"><%= items[j].priority %></span>
                        </div>
                        <div class="task-controls">
                            <form action="/edit/<%= i %>" method="GET" class="edit-form">
                                <button type="submit" class="edit-btn">Edit</button>
                            </form>
                            <form action="/delete/<%= i %>" method="POST" class="delete-form">
                                <button type="submit" class="delete-btn">Delete</button>
                            </form>
                        </div>
                    </div>
                <% } %>
            <% } else { %>
                <p>No tasks yet. Add something!</p>
            <% } %>
        </div>
                <form action="/" method="post" class="add-task-form" id="taskForm" onsubmit="return validateForm()">
            <div class="input-container">
                <input type="text" name="ele1" id="taskInput" placeholder="Enter your task">
                <select name="priority">
                    <option value="high">High</option>
                    <option value="medium" selected>Medium</option>
                    <option value="low">Low</option>
                </select>
            </div>
            <button type="submit" value="Add" class="add-btn">+</button>
        </form>
        
        <div id="alert" class="alert" style="display:none;">Please enter a task!</div>
        
        <script>
            function validateForm() {
                const taskInput = document.getElementById("taskInput");

                if (taskInput.value.trim() === "") {
                    alert("please enter a task!!!!!");
                    return false;
                }
                return true;
            }
        </script>
    </div>
</body>
</html>
